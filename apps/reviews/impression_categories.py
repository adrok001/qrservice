"""
Карта впечатлений (Impression Map) для ниши HoReCa
==================================================

HoReCa (Hotel/Restaurant/Cafe) — сегмент индустрии гостеприимства.

Категории описывают основные аспекты клиентского опыта,
упоминаемые в отзывах. Используются для аналитики и
автоматической классификации обратной связи.

Тональность (sentiment):
- positive — позитивное упоминание
- negative — негативное упоминание
- neutral  — нейтральное упоминание

Правила разметки:
1. Если в тексте нет явных упоминаний конкретных аспектов —
   ставить только "Общее/Общее впечатление"
2. "Комфорт/Атмосфера и интерьер" — только при наличии маркеров:
   уютно, атмосферно, интерьер, музыка, шумно, красиво, чисто
3. Не "размазывать" общие фразы по всем категориям —
   это искажает аналитику
"""

# Основные категории и их подкатегории
# ВАЖНО: "Безопасность" — критическая категория, выводить ПЕРВОЙ, красным цветом
IMPRESSION_CATEGORIES = {
    "Безопасность": ["Пищевая безопасность"],
    "Сервис": [
        "Сервис в целом",
        "Вежливость персонала",
        "Внимательность персонала",
        "Знание меню",
        "Решение проблем",
        "Тон общения",
        "Навязывание услуг",
    ],
    "Скорость": ["Скорость обслуживания"],
    "Продукт": ["Качество блюд", "Напитки", "Свежесть продуктов", "Размер порций"],
    "Цена": ["Цены"],
    "Комфорт": ["Атмосфера и интерьер", "Чистота"],
    "Процесс": [
        "Бронирование и посадка",
        "Управление/организация зала",
        "Точность заказа",
        "Расчёт с гостем",
        "Доставка и вынос",
        "Расположение",
    ],
    "Общее": ["Общее впечатление"],
}

# Маркеры категорий (ключевые слова для определения аспекта)
# CATEGORY_LEMMAS используется в segment_analyzer (set для быстрого поиска)
CATEGORY_LEMMAS = {
    "Безопасность": {
        "отравление", "отравить", "тошнота", "тошнить", "рвота", "рвать",
        "температура", "больница", "скорая", "диарея", "понос",
        "тухлятина", "тухлый", "протухнуть", "несвежий", "испорченный",
        "волос", "насекомое", "таракан", "муха", "червь", "плесень",  # посторонние предметы
    },
    "Сервис": {
        "сервис", "официант", "официантка", "персонал", "обслуживание",
        "сотрудник", "сотрудница", "менеджер",
        "администратор", "хостес", "бармен", "барменша", "повар", "девушка", "парень",
    },
    "Скорость": {
        "ждать", "ожидание", "долго", "быстро", "быстрый", "оперативный",
        "медленно", "медленный",
    },
    "Продукт": {
        "еда", "блюдо", "кухня", "готовить", "вкус", "вкусный", "невкусный",
        "обед", "завтрак", "ужин", "порция", "меню", "свежий", "горячий", "холодный",
        "салат", "суп", "борщ", "пицца", "паста", "стейк", "шашлык", "бургер",
        "суши", "ролл", "десерт", "торт", "кофе", "чай", "напиток", "вино", "пиво",
        "уксус", "пересоленный", "недосоленный", "безвкусный", "пресный",
        "черствый", "резиновый", "водянистый", "прогорклый",
    },
    "Цена": {
        "цена", "дорого", "дорогой", "дёшево", "дешёвый", "стоимость",
        "чек", "счёт", "бюджет", "переплатить", "недорого",
    },
    "Комфорт": {
        "атмосфера", "уютный", "уют", "интерьер", "дизайн", "декор", "обстановка",
        "музыка", "шумный", "громкий", "тихий", "красивый", "стильный",
        "чистый", "чистота", "грязный", "грязь", "туалет",
        "запах", "пахнуть", "вонь", "вонять", "воняет", "пахнет",
        "диван", "стул", "кресло", "мебель",
    },
    "Процесс": {
        "бронирование", "бронь", "столик", "резерв",
        "ошибка", "перепутать", "забыть",
        "оплата", "касса", "терминал", "карта", "наличные",
        "доставка", "самовывоз", "курьер", "парковка",
    },
    "Общее": {
        "место", "заведение", "ресторан", "кафе", "бар",
    },
}


# Маппинг маркеров/контекстных слов на конкретные подкатегории.
# Используется в segment_analyzer для выбора подкатегории вместо дефолтной первой.
SUBCATEGORY_MARKERS = {
    "Сервис": {
        "Вежливость персонала": {
            "вежливый", "вежливость", "уважение", "уважительный",
            "приветливый", "любезный", "доброжелательный",
            "милый", "приятный", "добрый", "дружелюбный",
            "душевный", "отзывчивый", "улыбчивый",
            "хам", "хамить", "хамство", "нахамить", "хамский", "хамски",
            "грубый", "грубость", "грубить", "грубо", "грубоватый",
            "наглый", "наглость", "невежливый", "невоспитанный",
            "конфликт", "скандал",
            "оскорбить", "оскорблять", "оскорбление",
            "представиться", "поздороваться", "улыбка", "гостеприимство",
            "гостеприимный", "радушный", "радушие",
            "неприветливый", "извиниться", "извинение", "извинить",
        },
        "Внимательность персонала": {
            "внимание", "внимательный", "невнимательный",
            "игнорировать", "забывать", "забыть",
            "отзывчивость", "заботливый",
            "встретить", "подойти", "подходить", "подошёл",
            "откликнуться", "позвать",
            "дозваться", "убрать", "спросить", "проверить",
            "вылавливать", "ловить", "искать",
            "забирать", "забрать", "уносить", "унести",  # "не забирает тарелки"
            "следить",  # "не следит за залом"
            "редко",  # "подходит редко"
            "равнодушный", "равнодушие", "безразличный", "безразличие",
        },
        "Знание меню": {
            "некомпетентный", "некомпетентность", "непрофессиональный",
            "непрофессионализм", "компетентный", "перепутать", "путать",
        },
        "Решение проблем": {
            "отказать", "отказаться", "отказывать", "отказ",
            "вернуть", "возврат", "компенсация",
            "решить", "решать", "решение", "проблема",
        },
        "Тон общения": {
            "тон", "повышать", "орать", "кричать", "голос",
            "пренебрежительный", "недовольный", "высокомерие", "высокомерный",
            "лгун", "лгунья",
            "надменный", "надменность", "свысока",
            "одолжение",  # "как одолжение", "делает одолжение"
        },
        "Навязывание услуг": {
            "навязывать", "навязать", "навязчивый",
        },
    },
    "Скорость": {
        "Скорость обслуживания": {
            "ждать", "ожидание", "долго", "прождать",
            "минута", "час", "полчаса",
            "быстро", "быстрый", "оперативный", "оперативно",
            "медленно", "медленный",
        },
    },
    "Продукт": {
        "Качество блюд": {
            "еда", "блюдо", "кухня", "готовить",
            "салат", "суп", "борщ", "пицца", "паста", "стейк", "шашлык", "бургер",
            "суши", "ролл", "десерт", "торт",
            "невкусный", "вкусный", "вкус",
            "подгореть", "подгорелый", "пересоленный", "недосоленный",
            "сырой", "недожаренный", "горелый", "пригорелый",
            "безвкусный", "пресный", "кислый", "уксус",
            "черствый", "резиновый", "водянистый", "прогорклый",
            "переваренный", "разваренный", "непропечённый", "непропеченный",
            "обветренный", "размокший", "пересохший",
        },
        "Напитки": {
            "кофе", "чай", "напиток", "вино", "пиво", "коктейль",
            "бармен", "бар",
        },
        "Свежесть продуктов": {
            "свежий", "несвежий", "качественный", "качество",
            "тухлый", "протухнуть", "тухлятина", "испорченный",
            "остыть", "остывший", "разогреть",
            "отсыреть", "отсыревший", "затхлый", "склизкий",
        },
        "Размер порций": {
            "порция", "крошечный", "маленький", "мизерный",
            "большой", "щедрый", "сытный",
        },
    },
    "Комфорт": {
        "Атмосфера и интерьер": {
            "атмосфера", "уютный", "уют", "интерьер", "дизайн", "декор",
            "обстановка", "музыка", "красивый", "стильный",
            "шумный", "громкий", "тихий", "душный", "тесный",
        },
        "Чистота": {
            "чистый", "чистота", "грязный", "грязь", "туалет",
            "запах", "пахнуть", "вонь", "вонять",
            "мусор", "антисанитария",
        },
    },
    "Процесс": {
        "Бронирование и посадка": {
            "бронирование", "бронь", "столик", "резерв", "занятый",
        },
        "Точность заказа": {
            "ошибка", "перепутать", "заказ",
        },
        "Расчёт с гостем": {
            "оплата", "касса", "терминал",
            "обсчитать", "переплатить", "счёт",
        },
        "Доставка и вынос": {
            "доставка", "самовывоз", "курьер",
        },
        "Расположение": {
            "парковка",
        },
    },
}

