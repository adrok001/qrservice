# Настройки проекта QR Service

Инструкция для Claude при проектировании фич.

---

## Формат ответов

### Пока НЕ понял задачу:
- Короткое резюме (3-5 строк): "Понял так: ..."
- Уточняющие вопросы (макс 3-4)
- **БЕЗ кода, диаграмм, моделей!**

### Когда понял и подтвердил:
- Схема моделей (компактная)
- План реализации
- Без лишних объяснений

---

## Принципы проектирования

### Ильяхов (тексты)
- Без воды — только суть
- Глаголы — "Сохранить", не "Сохранение"
- Польза — что получит пользователь
```
❌ "Произошла ошибка валидации"
✅ "Проверьте введённые данные"
```

### Лебедев (логика)
- Интерфейс объясняет сам себя
- Функция определяет форму
- Меньше элементов = меньше ошибок

### Apple (UX)
- Одна задача на экран
- Обратная связь на каждое действие
- Отмена возможна везде (undo)

### Google (система)
- Компоненты переиспользуются
- Паттерны консистентны
- Связи между сущностями явные

---

## Структура проекта

```
qrservice/
├── qrservice/           # Настройки Django
├── qrcode_app/          # Основное приложение
│   ├── models.py        # QRCode модель
│   ├── views.py         # Views (тонкие!)
│   ├── urls.py          # URL маршруты
│   ├── admin.py         # Админка
│   ├── static/          # CSS, JS
│   └── templates/       # HTML шаблоны
└── media/               # Загружаемые файлы
```

---

## Чеклист: о чём спрошу

### Создание (create)
- [ ] Что если уже существует похожее?
- [ ] Есть лимит? (макс. кол-во, размер)
- [ ] Какая валидация?

### Удаление (delete)
- [ ] Soft delete или hard delete?
- [ ] Каскадное удаление связанных?
- [ ] Можно отменить (undo)?

### Изменение (update)
- [ ] Какие поля можно менять?
- [ ] Нужна история изменений?

### Списки (list)
- [ ] Пагинация?
- [ ] Сортировка по умолчанию?
- [ ] Что показывать если пусто?

### Файлы
- [ ] Макс. размер?
- [ ] Разрешённые типы?

---

## Формат ТЗ

```markdown
## Задача: {название}

### Контекст
{Что и зачем — 2-3 предложения}

### Сначала исследуй
```bash
ls -la qrcode_app/
grep -r "class.*{похожее}" . --include="*.py"
```
Покажи что нашёл.

### План
Как реализовать? Покажи план, жди подтверждения.

### Модель (если нужна)
{Model} в qrcode_app/models.py
- {field} : {type}
- {field} → {Related} (FK)

### Логика
- {function}() → {что делает}

### UI
URL: /{path}/
```
{ASCII-схема}
```

### После реализации покажи
1. Какие файлы создал/изменил
2. python manage.py check
```

---

## Антипаттерны (предупреждать!)

| ❌ Плохо | ✅ Правильно |
|---------|-------------|
| Логика в view | Отдельная функция |
| Inline стили | CSS классы |
| Копипаста CSS | Переиспользование |
| Raw SQL | Django ORM |

---

## Пример сессии

**Ты:** Нужно добавить историю генераций для пользователя

**Я:** Уточню:
1. Хранить навсегда или последние N?
2. Привязка к авторизованному пользователю?
3. Показывать на отдельной странице?

**Ты:** Последние 50. Пока без авторизации, по сессии. Отдельная страница.

**Я:**
```
┌─────────────────────────────────────┐
│ QRHistory                           │
├─────────────────────────────────────┤
│ session_key : CharField             │
│ qr_code     → QRCode (FK)           │
│ created_at  : DateTime              │
├─────────────────────────────────────┤
│ qrcode_app/models.py                │
└─────────────────────────────────────┘
```

UI:
```
┌─────────────────────────────────────┐
│ История генераций                   │
├─────────────────────────────────────┤
│ [QR] https://example.com  12:30     │
│ [QR] Мой текст           12:25     │
│ [QR] +7999...            12:20     │
└─────────────────────────────────────┘
```

Согласен? Делаю.
